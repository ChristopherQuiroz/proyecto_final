{% extends "layout_cliente.html" %}

{% block cliente_extra_css %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/cliente/carrito.css') }}">
{% endblock %}

{% block cliente_content %}

<h2 class="titulo-carrito">Mi Carrito</h2>

<div class="carrito-layout">

    <!-- ====================================== TABLA DE PRODUCTOS ====================================== -->
    <div class="tabla-carrito">

        <!-- Encabezado -->
        <div class="fila encabezado">
            <span>Artículo</span>
            <span>Precio</span>
            <span>Cantidad</span>
            <span>Subtotal</span>
        </div>

        {% for p in productos %}
        <div class="fila producto">

            <!-- ARTÍCULO -->
            <div class="col-articulo">
                {% set img_url = url_for('static', filename='img/products/' ~ p.imagen) %}
                {% set default_img = url_for('static', filename='img/products/cupcake.jpg') %}

                <img src="{{ img_url }}" onerror="this.src='{{ default_img }}'">

                <span class="nombre">{{ p.nombre }}</span>
            </div>

            <!-- PRECIO -->
            <div class="col-precio">{{ p.precio }} Bs</div>

            <!-- CANTIDAD -->
            <div class="col-cantidad">
                <button onclick="actualizarCantidad('{{ p.id }}', 'restar')">−</button>
                <input type="text" value="{{ p.cantidad }}" readonly>
                <button onclick="actualizarCantidad('{{ p.id }}', 'sumar')">+</button>
            </div>

            <!-- SUBTOTAL -->
            <div class="col-subtotal">{{ p.subtotal }} Bs</div>

        </div>
        {% endfor %}

    </div>

    <!-- ====================================== RESUMEN ====================================== -->
    <div class="resumen-carrito">
        <h3>Resumen</h3>
        <hr>

        <div class="resumen-linea">
            <span>Total del pedido</span>
            <span>{{ total }} Bs</span>
        </div>

        <form action="/cliente/pagar" method="POST">
            <button class="btn-pagar">Tramitar pedido</button>
        </form>
    </div>

</div>

<script>
function eliminarDelCarrito(id) {
    window.location.href = "/cliente/carrito/eliminar/" + id;
}

function actualizarCantidad(id, accion) {
    window.location.href = "/cliente/carrito/actualizar/" + id + "/" + accion;
}

</script>

{% endblock %}
