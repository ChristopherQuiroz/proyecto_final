{% extends "layout_cliente.html" %}

{% block cliente_extra_css %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/cliente/dashboard.css') }}">
{% endblock %}

{% block cliente_content %}

<!-- ========================================
                HERO PRINCIPAL
======================================== -->
<section class="hero">
    <div class="hero-slider">

        {% for img in banners %}
            <img src="{{ url_for('static', filename=img) }}"
                 class="hero-img {% if loop.first %}active{% endif %}">
        {% endfor %}

        <div class="hero-overlay"></div>

        <button class="hero-arrow left">‹</button>
        <button class="hero-arrow right">›</button>

        <div class="hero-dots"></div>

        <div class="hero-content">
            <p class="hero-kicker">Pastelería artesanal</p>
            <h1>Regálate un<br><span>gran dulce momento</span></h1>
            <p class="hero-sub">Ordena en línea y recoge en tu sucursal favorita.</p>
            <a href="/cliente/productos" class="hero-btn">Comprar ahora</a>
        </div>

    </div>
</section>



<!-- ========================================
            CATEGORÍAS (CARRUSEL)
======================================== -->
<section class="section section-categorias">
    <h2 class="section-title">Categorías</h2>

    <div class="categorias-carrusel">

        <!-- Flecha izquierda -->
        <button type="button" class="arrow arrow-left">‹</button>

        <div class="categorias-track">

            {% for cat in categorias %}
            {% set img_url = url_for('static', filename='img/categories/' ~ cat.icono) %}
            {% set default_img = url_for('static', filename='img/products/cupcake.jpg') %}

            <!-- TARJETA COMPLETA CLICKEABLE -->
           <a href="/cliente/categorias?cat={{ cat.id }}" class="cat-card-link">
                <article class="cat-card">
                    <div class="cat-img-container">
                        <img src="{{ img_url }}"
                             class="cat-img"
                             onerror="this.src='{{ default_img }}'">
                    </div>
                    <h3 class="cat-name">{{ cat.nombre }}</h3>
                </article>
            </a>

            {% endfor %}
        </div>

        <!-- Flecha derecha -->
        <button type="button" class="arrow arrow-right">›</button>

    </div>
</section>



<!-- ========================================
            ESPECIALES DEL MES
======================================== -->
<section class="section">
    <h2 class="section-title">Especiales del mes</h2>

    <div class="productos-grid">
        {% for p in productos %}

        {% set img_url = url_for('static', filename='img/products/' ~ p.imagen) %}
        {% set default_img = url_for('static', filename='img/products/cupcake.jpg') %}

        <article class="product-card">
            <div class="img-container">
                <img src="{{ img_url }}"
                     class="product-img"
                     onerror="this.src='{{ default_img }}'"
                     alt="{{ p.nombre }}">
            </div>

            <div class="info">
                <h3>{{ p.nombre }}</h3>
                <p class="precio">Bs {{ p.precio }}</p>
            </div>

            <a href="/cliente/producto/{{ p.id }}" class="btn-comprar">Ver producto</a>
        </article>

        {% endfor %}
    </div>
</section>

{% endblock %}



{% block extra_js %}
<script>
// =========================
// CARRUSEL DE CATEGORÍAS
// =========================
document.addEventListener("DOMContentLoaded", () => {
    const track = document.querySelector(".categorias-track");
    const btnLeft = document.querySelector(".arrow-left");
    const btnRight = document.querySelector(".arrow-right");

    if (!track) return;

    btnRight.addEventListener("click", () => {
        track.scrollBy({ left: 260, behavior: "smooth" });
    });

    btnLeft.addEventListener("click", () => {
        track.scrollBy({ left: -260, behavior: "smooth" });
    });
});


// =========================
// SLIDER DEL HERO
// =========================
document.addEventListener("DOMContentLoaded", () => {

    const images = document.querySelectorAll(".hero-img");
    const dotsContainer = document.querySelector(".hero-dots");
    const arrowLeft = document.querySelector(".hero-arrow.left");
    const arrowRight = document.querySelector(".hero-arrow.right");

    let index = 0;

    // Crear puntitos dinámicamente
    images.forEach((_, i) => {
        const dot = document.createElement("div");
        dot.classList.add("hero-dot");
        if (i === 0) dot.classList.add("active");

        dot.addEventListener("click", () => {
            goToSlide(i);
            resetInterval();
        });

        dotsContainer.appendChild(dot);
    });

    const dots = document.querySelectorAll(".hero-dot");

    function goToSlide(i) {
        images[index].classList.remove("active");
        dots[index].classList.remove("active");

        index = i;

        images[index].classList.add("active");
        dots[index].classList.add("active");
    }

    function nextSlide() {
        let next = (index + 1) % images.length;
        goToSlide(next);
    }

    function prevSlide() {
        let prev = (index - 1 + images.length) % images.length;
        goToSlide(prev);
    }

    // Auto-slide
    let slideInterval = setInterval(nextSlide, 4000);

    function resetInterval() {
        clearInterval(slideInterval);
        slideInterval = setInterval(nextSlide, 4000);
    }

    // Flechas
    arrowRight.addEventListener("click", () => {
        nextSlide();
        resetInterval();
    });

    arrowLeft.addEventListener("click", () => {
        prevSlide();
        resetInterval();
    });

});

</script>
{% endblock %}
