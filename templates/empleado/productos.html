{% extends "layout_empleado.html" %}

{% block extra_css %}
    {{ super() }}
    <link rel="stylesheet" href="{{ url_for('static', filename='css/empleado/productos.css') }}">
{% endblock %}

{% block empleado_content %}

<h2 class="titulo-cat">Productos</h2>

<!-- BUSCADOR -->
<div class="buscador-agregar">
    <input type="text" id="buscar-producto" class="input-buscar" placeholder="Buscar producto...">
</div>

<!-- GRID DE PRODUCTOS -->
<div class="productos-grid">
    {% for producto in productos %}
    <div class="card-producto">

        {% set img_url = url_for('static', filename='img/products/' ~ producto.name ~ '.jpg') %}
        {% set default_img = url_for('static', filename='img/products/cupcake.jpg') %}

        <img src="{{ img_url }}"
             class="producto-img"
             onerror="this.src='{{ default_img }}'">

        <div class="producto-info">
            <h3 class="producto-nombre">{{ producto.name }}</h3>

            <p class="producto-descripcion">
                {{ producto.description[:60] if producto.description else '' }}...
            </p>

            <div class="producto-datos">
                <span><strong>Bs:</strong> {{ "%.2f"|format(producto.price|float) }}</span>
                <span><strong>Stock:</strong> {{ producto.quantity }}</span>
                <span><strong>Cat:</strong> {{ producto.category }}</span>
            </div>

            <p class="producto-estado {{ producto.status|lower }}">
                {{ producto.status }}
            </p>
        </div>

        <button disabled class="btn-ver">Ver</button>

    </div>
    {% endfor %}
</div>

<!-- SCRIPT FILTRO -->
<script>
document.getElementById('buscar-producto').addEventListener('input', function(e) {
    const term = e.target.value.toLowerCase();
    document.querySelectorAll('.card-producto').forEach(card => {
        const nombre = card.querySelector('.producto-nombre').textContent.toLowerCase();
        card.style.display = nombre.includes(term) ? 'flex' : 'none';
    });
});
</script>

{% endblock %}
